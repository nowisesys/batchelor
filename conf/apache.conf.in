# Apache webserver configuration file.
# 
# Include this file in your main apache conf (usually /etc/apache/httpd.conf) as: 
# Include /var/www/localhost/apps/batchelor/conf/apache.conf
#
# If you got an /etc/apache2/webapps.d,then simply create a symbolic link:
# ln -s /var/www/localhost/apps/batchelor/conf/apache.conf \
#       /etc/apache2/webapps.d/batchelor.conf
#
# Enable the web service interfaces by appending -D WEB_SERVICE to the command 
# line argument for Apache. On Gentoo this is done /etc/conf.d/apache2. Make 
# sure to set access permissions on respective web service interface below.
#
# Restart the webserver for changes to take effect.
# 

<IfDefine WEB_SERVICE>
  # Prevent mapping script to request broker:
  AliasMatch ^/batchelor/ws/http/(.*).php /var/www/localhost/apps/batchelor/source/ws/http/$1.php
  # Transform xxx/?yyy into broker.php?name=xxx&yyy:
  AliasMatch ^/batchelor/ws/http/(.*) /var/www/localhost/apps/batchelor/source/ws/http/broker.php
  # Transform x/y/z into index.php/x/y/z:
  AliasMatch ^/batchelor/ws/rest/(.*) /var/www/localhost/apps/batchelor/source/ws/rest/index.php
</IfDefine>

Alias /batchelor/ /var/www/localhost/apps/batchelor/source/

<DirectoryMatch ".*/\.svn/">
    Order allow,deny
    Deny from all
</DirectoryMatch>
	
<Directory /var/www/localhost/apps/batchelor/source/>
    Order deny,allow
    Deny from all
    # Allow from localhost (ipv4/ipv6) by default:
    Allow from 127.0.0.1 ::1
    Options Indexes FollowSymLinks MultiViews
    DirectoryIndex index.php index.html
    # Files that should not be readable as plain text by world.
    # For Apache version < 1.3:
    #   <Files ~ "\.(inc|js)$">
    #       Order allow,deny
    #       Deny from all
    #   </Files>
    # For Apache version >= 1.3:
    #   <FilesMatch "\.(inc|bak|*~)$">
    #       Order allow,deny
    #       Deny from all
    #   </FilesMatch>
    # For Apache version >= 2.0.x:
    <FilesMatch "\.(inc|bak|conf|.*~)$">
        Order allow,deny
	Deny from all
    </FilesMatch>
</Directory>

<IfDefine WEB_SERVICE>
    # Directory for the XML-RPC protocol:
    <Directory /var/www/localhost/apps/batchelor/source/ws/xmlrpc/>
        Order deny,allow
    	Deny from all
    	Allow from 127.0.0.1 ::1
    	Options Indexes FollowSymLinks MultiViews
    </Directory>

    # Directory for the HTTP RPC protocol:
    <Directory /var/www/localhost/apps/batchelor/source/ws/http/>
        Order deny,allow
    	Deny from all
    	Allow from 127.0.0.1 ::1
    	Options Indexes FollowSymLinks MultiViews
    </Directory>
    
    # Directory for the REST protocol:
    <Directory /var/www/localhost/apps/batchelor/source/ws/rest/>
        Order deny,allow
    	Deny from all
    	Allow from 127.0.0.1 ::1
    	Options Indexes FollowSymLinks MultiViews
    </Directory>

    # Directory for the SOAP protocol:
    <Directory /var/www/localhost/apps/batchelor/source/ws/soap/>
        Order deny,allow
    	Deny from all
    	Allow from 127.0.0.1 ::1
    	Options Indexes FollowSymLinks MultiViews
    </Directory>

    # Directory for WSDL:
    <Directory /var/www/localhost/apps/batchelor/source/ws/wsdl/>
        Order deny,allow
    	Deny from all
    	Allow from 127.0.0.1 ::1
    	Options Indexes FollowSymLinks MultiViews
	DirectoryIndex batchelor.wsdl
    </Directory>
</IfDefine>

<IfDefine !WEB_SERVICE>
    <Directory /var/www/localhost/apps/batchelor/source/ws/>
    	Deny from all
    </Directory>
</IfDefine>
