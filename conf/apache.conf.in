# Apache webserver configuration file.
# 
# Include this file in your main apache conf (usually /etc/apache/httpd.conf) as: 
# Include /var/www/localhost/apps/batchelor/conf/apache.conf
#
# If you got an /etc/apache2/webapps.d,then simply create a symbolic link:
# ln -s /var/www/localhost/apps/batchelor/conf/apache.conf \
#       /etc/apache2/webapps.d/batchelor.conf
#
# Enable the web service interfaces by appending -D WEB_SERVICE to the command 
# line argument for Apache. On Gentoo this is done /etc/conf.d/apache2. Make 
# sure to set access permissions on respective web service interface below.
#
# Restart the webserver for changes to take effect.
# 

<IfDefine WEB_SERVICE>
  # Prevent mapping script to request broker:
  AliasMatch ^/batchelor/ws/http/(.*).php /var/www/localhost/apps/batchelor/source/ws/http/$1.php
  # Transform xxx/?yyy into broker.php?name=xxx&yyy:
  AliasMatch ^/batchelor/ws/http/(.*) /var/www/localhost/apps/batchelor/source/ws/http/broker.php
  # Transform x/y/z into index.php/x/y/z:
  AliasMatch ^/batchelor/ws/rest/(.*) /var/www/localhost/apps/batchelor/source/ws/rest/index.php
</IfDefine>

Alias /batchelor/ /var/www/localhost/apps/batchelor/source/

<DirectoryMatch ".*/\.svn/">
    Require all denied
</DirectoryMatch>
	
<Directory /var/www/localhost/apps/batchelor/source/>
    # Allow from localhost (ipv4/ipv6) by default:
    Require local
    
    Options Indexes FollowSymLinks MultiViews
    DirectoryIndex index.php index.html
    
    <FilesMatch "\.(inc|bak|conf|.*~)$">
	Require all denied
    </FilesMatch>
</Directory>

<IfDefine WEB_SERVICE>
    # Directory for the XML-RPC protocol:
    <Directory /var/www/localhost/apps/batchelor/source/ws/xmlrpc/>
	Require local
    	Options Indexes FollowSymLinks MultiViews
    </Directory>

    # Directory for the HTTP RPC protocol:
    <Directory /var/www/localhost/apps/batchelor/source/ws/http/>
	Require local
    	Options Indexes FollowSymLinks MultiViews
    </Directory>
    
    # Directory for the REST protocol:
    <Directory /var/www/localhost/apps/batchelor/source/ws/rest/>
	Require local
    	Options Indexes FollowSymLinks MultiViews
    </Directory>

    # Directory for the SOAP protocol:
    <Directory /var/www/localhost/apps/batchelor/source/ws/soap/>
	Require local
    	Options Indexes FollowSymLinks MultiViews
    </Directory>

    # Directory for XML Schemas (WSDL and REST XSD):
    <Directory /var/www/localhost/apps/batchelor/source/ws/schema/>
	Require local
    	Options Indexes FollowSymLinks MultiViews
    </Directory>
</IfDefine>

<IfDefine !WEB_SERVICE>
    <Directory /var/www/localhost/apps/batchelor/source/ws/>
	Require all denied
    </Directory>
</IfDefine>
